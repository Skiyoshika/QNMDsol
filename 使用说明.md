# 🧠 QNMDsol 使用说明书
**Quick Neural Mind-Driven Souls-like Controller (v0.1 Demo)**

欢迎使用 **QNMDsol**！这是一款专为《艾尔登法环》、《噬血代码》等高难度动作游戏设计的脑机接口控制系统。通过读取您的脑电波（或面部肌电信号），将其转化为虚拟手柄指令，实现“意念”玩游戏。

本文档将指导您配置环境、连接设备以及进行全流程测试。

---

## 📋 1. 环境准备 (Prerequisites)

在运行程序之前，请确保您的电脑满足以下条件：

### 🛠️ 硬件需求
* **OpenBCI 头戴设备:** Cyton 板卡 + Daisy 扩展板 (共16通道)。
* **USB 接收器 (Dongle):** 需插入电脑 USB 接口。
    * *注意：代码默认端口为 `COM4`。如果您的端口不同，请在设备管理器查看并在代码中修改。*

### 💻 软件需求
1.  **操作系统:** Windows 10 或 Windows 11 (64位)。
2.  **vJoy 虚拟手柄驱动:**
    * 请下载并安装 [vJoy](https://github.com/shauleiz/vJoy/releases)。
    * 安装后，请确保配置了一个默认的虚拟设备 (Device 1)。
3.  **核心驱动文件 (DLL):**
    为了防止程序闪退，您的项目根目录 (`E:\QNMDsol\`) **必须** 包含以下文件：
    * `BoardController.dll`
    * `DataHandler.dll`
    * `vJoyInterface.dll`

---

## 🎮 2. 运行模式说明
在终端运行以下命令启动程序：

```bash
cargo run
```

启动后，左侧控制面板提供两种模式：SIM (模拟) 和 REAL (真实)。

**🅰️ SIM 模式 (全真模拟)**
用途： 在没有佩戴设备时，测试软件逻辑、界面显示和 vJoy 手柄映射是否正常。 原理： 使用 键盘按键 来模拟大脑产生特定信号，从而触发手柄动作。

操作步骤：

在左上角选择 SIM。

点击 CONNECT (连接模拟器)。

点击 START STREAM (开始数据流)。此时你会看到波形图开始滚动。

键盘控制 (模拟脑波):

W / A / S / D: 推懂虚拟手柄的 左摇杆 (移动)。

I / J / K / L: 推懂虚拟手柄的 右摇杆 (视角)。

空格键 (Space): 触发 A 键 (跳跃/确认)。

Z / X / C: 分别触发 B / X / Y 键。

现象：按下键盘时，波形图会产生剧烈波动，左侧的手柄可视化面板会实时点亮对应的按键。

**🅱️ REAL 模式 (硬件实战)**
用途： 连接 OpenBCI，用真实的生物信号控制游戏。

操作步骤：

插入 USB Dongle，打开脑电帽电源。

选择 REAL。

点击 CONNECT。

成功： 按钮变红显示 DISCONNECT，日志提示 "Hardware Connected"。

失败： 检查端口是否被占用，或开关是否拨到 PC 模式。

点击 START STREAM。屏幕将显示实时的 16 通道脑电波形。

控制方法：

咬牙 (Jaw Clench) 或眨眼会产生极强的肌电信号。

当信号强度超过 Trigger Threshold (默认 200.0 uV) 时，会触发攻击指令 (A键)。

---

## 💾 3. AI 数据采集 (Data Collection)
为了训练个性化的 AI 模型，您需要录制自己的脑波数据。

注意：此功能仅在 REAL 模式下可用。

连接硬件并开始推流 (Start Stream)。

在左侧 AI DATA COLLECTION 下方的文本框输入标签名。

例如输入：Attack (代表攻击动作) 或 Rest (代表放松)。

点击 🔴 RECORD 开始录制。

此时请执行对应的动作（如用力咬牙，或保持放松）。

点击 ⏹ STOP 结束录制。

数据将自动保存为 .csv 文件，位于项目根目录下。

---

## 🔧 4. 常见问题 (FAQ)
Q: 点击 CONNECT 后程序直接闪退？

A: 99% 是因为缺少 DLL 文件。请确保 BoardController.dll 就在 .exe 旁边或者项目根目录下。

Q: 报错 "Port Open Failed"?

A: 请检查 USB Dongle 是否插好；检查是否有其他软件（如 OpenBCI GUI）正在占用这个 COM 口。

Q: 模拟模式下，按键盘手柄没反应？

A: 请确保你点击了 START STREAM，并且选中了程序窗口（使其获得焦点）。

Q: 波形图太乱了怎么办？

A: 点击左侧的 🔄 RESET VIEW 按钮可以清空当前波形，重新绘制。

---

**QNMDsol - Made by Independent Developer.**
